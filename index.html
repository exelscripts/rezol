function createAccount() {
  const username = document.getElementById('username').value;
  const password = document.getElementById('password').value;

  if (!username || !password) {
    alert('Please enter both username and password.');
    return;
  }

  currentUser = username;
  balance = 0; // Reset balance when creating a new account
  loggedIn = true;

  checkLoginStatus();
}

function togglePurchaseSection() {
  const purchaseSection = document.getElementById('purchase-container');
  purchaseSection.style.display = purchaseSection.style.display === 'none' ? 'block' : 'none';
}

function updatePrice() {
  const hours = document.getElementById('hours-to-buy').value;
  if (hours < 2) {
    document.getElementById('hours-to-buy').value = 2;
  }
  const totalCost = hours * 4;
  document.getElementById('total-cost').textContent = totalCost;
}

function purchaseHours() {
  const hours = document.getElementById('hours-to-buy').value;
  const totalCost = hours * 4;

  if (balance >= totalCost) {
    balance -= totalCost;
    document.getElementById('balance-amount').textContent = balance.toFixed(2);
    generateKey();
  } else {
    alert('Insufficient balance!');
  }
}

function generateKey() {
  const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
  let key = '';
  for (let i = 0; i < 20; i++) {
    key += chars.charAt(Math.floor(Math.random() * chars.length));
  }
  displayGeneratedKey(key);
}

function displayGeneratedKey(key) {
  const keyDisplay = document.getElementById('key-display');
  const keyText = document.getElementById('generated-key');
  const copyButton = document.getElementById('copy-button');

  keyText.textContent = key;
  keyDisplay.style.display = 'block';

  copyButton.onclick = function() {
    navigator.clipboard.writeText(key).then(function() {
      showGreenMessage();
    });
  };
}

function showGreenMessage() {
  const message = document.getElementById('green-message');
  message.classList.add('show');
  setTimeout(function() {
    message.classList.remove('show');
  }, 3000);
}

function copyKey() {
  const key = document.getElementById('generated-key').textContent;
  navigator.clipboard.writeText(key).then(function() {
    showGreenMessage();
  });
}
